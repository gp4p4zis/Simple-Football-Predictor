{% extends "matches/base.html" %}
{% load math_filters %}
{% block content %}
  <h2>{{ match.home_team }} vs {{ match.away_team }}</h2>
  <p>{{ match.kickoff_at|date:"D, d M Y H:i" }}</p>

  {% if match.status == "FINISHED" %}
    <p>Final Score: {{ match.home_score }} - {{ match.away_score }}</p>
  {% else %}
    <form method="post" action="{% url 'generate_prediction' match.id %}">
      {% csrf_token %}
      <button type="submit">Generate Prediction</button>
    </form>

    {% if model_prediction %}
      <div class="card mt-3 p-3 border rounded bg-light">
        <h3>{% if model_prediction.acc %}(Accuracy ~{{ model_prediction.acc }}%){% else %}(Accuracy N/A){% endif %}</h3>
        <ul>
          <li>Home Win: {{ model_prediction.probs.H|mul:100|floatformat:1 }}%</li>
          <li>Draw: {{ model_prediction.probs.D|mul:100|floatformat:1 }}%</li>
          <li>Away Win: {{ model_prediction.probs.A|mul:100|floatformat:1 }}%</li>
        </ul>
        <h3>Predicted Betting Odds</h3>
        <ul>
          <li>1: {{ model_prediction.odds.H }}</li>
          <li>X: {{ model_prediction.odds.D }}</li>
          <li>2: {{ model_prediction.odds.A }}</li>
        </ul>
      </div>
    {% else %}
      <p class="text-muted mt-2">Not enough data to generate a prediction yet.</p>
    {% endif %}
  {% endif %}
{% endblock %}
